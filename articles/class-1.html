<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pbda">
<title>Class 1: Course Overview | Data Import and Tidying • pbda</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Source%20Sans%20Pro-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Source%20Code%20Pro-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Class 1: Course Overview | Data Import and Tidying">
<meta property="og:description" content="pbda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="rnabioco.github.io" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pbda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-class-material">Class Material</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-class-material">
    <a class="dropdown-item" href="../articles/class-1.html">Class 1: Overview, Data Import and Tidying</a>
    <a class="dropdown-item" href="../articles/class-2.html">Class 2: Analyzing qPCR data</a>
    <a class="dropdown-item" href="../articles/class-5.html">Class 5: Basic Data Types and Structures</a>
    <a class="dropdown-item" href="../articles/class-6.html">Class 6: Writing Functions</a>
    <a class="dropdown-item" href="../articles/class-7.html">Class 7: Iteration</a>
    <a class="dropdown-item" href="../articles/class-8.html">Class 8: Heatmaps and Clustering</a>
    <a class="dropdown-item" href="../articles/class-9.html">Class 9: Exploring data with PCA</a>
    <a class="dropdown-item" href="../articles/class-10.html">Class 10: Jumping into more complex R, tips, resources</a>
    <a class="dropdown-item" href="../articles/class-11.html">Class 11: RNA-seq Analysis</a>
    <a class="dropdown-item" href="../articles/class-12.html">Class 12: Working with gene lists</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/assignments.html">Assignment Submission and Grading Rubric</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rnabioco/practical-data-analysis/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Class 1: Course Overview | Data Import and Tidying</h1>
                        <h4 data-toc-skip class="author">Jay Hesselberth</h4>
            
            <h4 data-toc-skip class="date">2022-07-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rnabioco/practical-data-analysis/blob/HEAD/vignettes/class-1.Rmd" class="external-link"><code>vignettes/class-1.Rmd</code></a></small>
      <div class="d-none name"><code>class-1.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="goals-for-the-course">Goals for the course<a class="anchor" aria-label="anchor" href="#goals-for-the-course"></a>
</h2>
<ul>
<li><p><strong>Master the basics of data import, processing, plotting, and report generation in RStudio.</strong></p></li>
<li><p><strong>Get hooked on RStudio instead of MS Excel, Prism, etc as your go-to analysis software.</strong></p></li>
<li><p><strong>Learn productive analysis habits.</strong></p></li>
<li><p><strong>Understand the analysis ecosystem so that new types of data are easily approachable</strong></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="rstudio-overview">RStudio Overview<a class="anchor" aria-label="anchor" href="#rstudio-overview"></a>
</h2>
<!-- We'll cover the basic steps of data import and analysis within RStudio and will highlight some features of the software as we go. -->
<p><strong>The class has its own R package, so you should begin by loading it into your session.</strong> You will need to reinstall the package when we make updates.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github('rnabioco/practical-data-analysis')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rnabioco/practical-data-analysis" class="external-link">pbda</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="environment">Environment<a class="anchor" aria-label="anchor" href="#environment"></a>
</h2>
<p>The Environment panel enables data import and environment browsing.</p>
<p>There are two main ways to import data within RStudio. One is interactive, using the “Import Dataset” button in the Environment panel.</p>
<div class="figure">
<img src="img/class-1-data-import.png" alt=""><p class="caption">data import</p>
</div>
</div>
<div class="section level2">
<h2 id="read-functions">
<code>read</code> functions<a class="anchor" aria-label="anchor" href="#read-functions"></a>
</h2>
<p>Alternatively you can use functions in <code>readr</code> and <code>readxl</code> to load data on the console or within an RMarkdown report. All of the functions have <code>read_*</code> prefixes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://readr.tidyverse.org/reference/readr_example.html" class="external-link">readr_example</a></span><span class="op">(</span><span class="st">"mtcars.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">32</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">11</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (11): mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 11</span></span></span>
<span><span class="co">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  21       6  160    110  3.9   2.62  16.5     0     1     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  21       6  160    110  3.9   2.88  17.0     0     1     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  24.4     4  147.    62  3.69  3.19  20       1     0     4     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 22 more rows</span></span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/readxl_example.html" class="external-link">readxl_example</a></span><span class="op">(</span><span class="st">"datasets.xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 150 × 5</span></span></span>
<span><span class="co">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          5.1         3.5          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          4.9         3            1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          4.7         3.2          1.3         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          4.6         3.1          1.5         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          5           3.6          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          5.4         3.9          1.7         0.4 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          4.6         3.4          1.4         0.3 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          5           3.4          1.5         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          4.4         2.9          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          4.9         3.1          1.5         0.1 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 140 more rows</span></span></span></code></pre></div>
<p>You can also explore your environment with the “Global Environment” button.</p>
</div>
<div class="section level2">
<h2 id="console">Console<a class="anchor" aria-label="anchor" href="#console"></a>
</h2>
<p>The Console panel enables interactive analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ───────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.9</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.7     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.2.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ──────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span></code></pre></div>
<p>This one invocation loads several libraries including <code>dplyr</code> and <code>ggplot2</code>.</p>
</div>
<div class="section level2">
<h2 id="viewer">Viewer<a class="anchor" aria-label="anchor" href="#viewer"></a>
</h2>
<p>The <code>tidyverse</code> contains <code>ggplot2</code>, which you covered in your pre-requisites. Let’s make a simple plot in RStudio. Note that the plot appears in the “Plots” panel. From there, you can Zoom, Export to a file, or Publish on RPubs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, y <span class="op">=</span> <span class="va">mpg</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="class-1_files/figure-html/plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="editor">Editor<a class="anchor" aria-label="anchor" href="#editor"></a>
</h2>
<p>Finally we’ll create an RMarkdown document in the Editor panel. Select File &gt; New File &gt; RMarkdown… and fill the Title and Author fields. Then click OK to create an RMarkdown document. When you have completed editing the document, click the “Knit” button to render the output (e.g., as an HTML page).</p>
<p>Rmarkdown is customizable with tables of contents, tabbed views and more. See the <a href="http://rmarkdown.rstudio.com/articles.html" class="external-link">Rmarkdown documentation</a> for examples.</p>
</div>
<div class="section level2">
<h2 id="projects">Projects<a class="anchor" aria-label="anchor" href="#projects"></a>
</h2>
<p>RStudio provides a “Project” concept to keep related analyses together. I suggest starting each class by making your own project (File &gt; New Project).</p>
</div>
<div class="section level2">
<h2 id="tidyverse-cheatsheets">Tidyverse cheatsheets<a class="anchor" aria-label="anchor" href="#tidyverse-cheatsheets"></a>
</h2>
<p>See <code>Help &gt; Cheatsheets</code> for helpful references. Print them out and pin them up next to your screen. The <code>dplyr</code> and <code>ggplot2</code> cheatsheets are especially useful for beginners.</p>
</div>
<div class="section level2">
<h2 id="git-and-github">Git and Github<a class="anchor" aria-label="anchor" href="#git-and-github"></a>
</h2>
<p>Github provides several advantages:</p>
<ul>
<li>
<strong>Revision control.</strong> You have a history of all changes to your documents and can go back to any point.</li>
<li>
<strong>Collaboration.</strong> It is easy to share analyses with your colleagues and is built to enable multiple people to work an a common project.</li>
<li>
<strong>Publicity.</strong> Your github page reflects your interests and productivity. Others might visit to evaluate your code samples.</li>
</ul>
<p>Jenny Bryan’s <a href="http://happygitwithr.com/" class="external-link">“Happy Git with R”</a> tutorial gets you up and running by integrating Git and R Studio.</p>
<p>We’ll be using github to submit problem sets, so make sure this is set up by class time on Thursday.</p>
<div class="section level4">
<h4 id="formatting-data-for-efficient-analysis">Formatting data for efficient analysis<a class="anchor" aria-label="anchor" href="#formatting-data-for-efficient-analysis"></a>
</h4>
<p>Reformatting your data into “tidy” format is a useful practice that allows you efficiently manipulate and analyze data. We will start with some toy examples and then will reformat a commonly used data type from a quantitative PCR experiment.</p>
<p>Tidy data adopts three simple conventions:</p>
<ol style="list-style-type: decimal">
<li><strong>Columns are variables.</strong></li>
<li><strong>Rows are observations.</strong></li>
<li>Store related data in separate tables.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="the-tibble">The <code>tibble</code><a class="anchor" aria-label="anchor" href="#the-tibble"></a>
</h2>
<p>A <code>tibble</code> is similar to a <code>data.frame</code> with some important differences. A <code>tibble</code> provides a quick overview of your data including its structure (rows and columns) and column types. Use <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble()</a></code> to convert a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 150 × 5</span></span></span>
<span><span class="co">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          5.1         3.5          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          4.9         3            1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          4.7         3.2          1.3         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          4.6         3.1          1.5         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          5           3.6          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          5.4         3.9          1.7         0.4 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          4.6         3.4          1.4         0.3 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          5           3.4          1.5         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          4.4         2.9          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          4.9         3.1          1.5         0.1 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 140 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-tidyr-package">The <code>tidyr</code> package<a class="anchor" aria-label="anchor" href="#the-tidyr-package"></a>
</h2>
<p>The <code>tidyr</code> package has useful functions to format data for efficient analysis. See the <a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" class="external-link">cheat sheet</a> for reference.</p>
</div>
<div class="section level2">
<h2 id="gather-and-spread">
<code>gather</code> and <code>spread</code><a class="anchor" aria-label="anchor" href="#gather-and-spread"></a>
</h2>
<p>These are the workhorse functions in <code>tidyr</code>. Use <code>gather</code> when variables are in columns and you want them in tidy format.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rnabioco/practical-data-analysis" class="external-link">pbda</a></span><span class="op">)</span></span>
<span><span class="co"># column names in "wide" format are variables</span></span>
<span><span class="va">mtcars_tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 12</span></span></span>
<span><span class="co">#&gt;    name    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Mazd…  21       6  160    110  3.9   2.62  16.5     0     1     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mazd…  21       6  160    110  3.9   2.88  17.0     0     1     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Dats…  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Horn…  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Horn…  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Vali…  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Dust…  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Merc…  24.4     4  147.    62  3.69  3.19  20       1     0     4     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Merc…  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Merc…  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 22 more rows</span></span></span>
<span></span>
<span><span class="co"># gather variables and observations into `key` and `value` columns - so-called "long" format</span></span>
<span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="va">mtcars_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">key</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="va">xx</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 352 × 3</span></span></span>
<span><span class="co">#&gt;    name              key   value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Mazda RX4         mpg    21  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mazda RX4 Wag     mpg    21  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Datsun 710        mpg    22.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Hornet 4 Drive    mpg    21.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Hornet Sportabout mpg    18.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Valiant           mpg    18.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Duster 360        mpg    14.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Merc 240D         mpg    24.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Merc 230          mpg    22.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Merc 280          mpg    19.2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 342 more rows</span></span></span>
<span></span>
<span><span class="co"># and convert back to "wide" format</span></span>
<span><span class="va">xx</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">key</span>, <span class="va">value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 12</span></span></span>
<span><span class="co">#&gt;    name     am  carb   cyl  disp  drat  gear    hp   mpg  qsec    vs    wt</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AMC …     0     2     8 304    3.15     3   150  15.2  17.3     0  3.44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Cadi…     0     4     8 472    2.93     3   205  10.4  18.0     0  5.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Cama…     0     4     8 350    3.73     3   245  13.3  15.4     0  3.84</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Chry…     0     4     8 440    3.23     3   230  14.7  17.4     0  5.34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Dats…     1     1     4 108    3.85     4    93  22.8  18.6     1  2.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Dodg…     0     2     8 318    2.76     3   150  15.5  16.9     0  3.52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Dust…     0     4     8 360    3.21     3   245  14.3  15.8     0  3.57</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Ferr…     1     6     6 145    3.62     5   175  19.7  15.5     0  2.77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Fiat…     1     1     4  78.7  4.08     4    66  32.4  19.5     1  2.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Fiat…     1     1     4  79    4.08     4    66  27.3  18.9     1  1.94</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 22 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="long-format">Long format<a class="anchor" aria-label="anchor" href="#long-format"></a>
</h2>
<p>Each form has its advantages. For example, long format makes it easy to calculate summaries:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xx</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 2</span></span></span>
<span><span class="co">#&gt;    key   `median(value)`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> am               0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> carb             2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> cyl              6   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> disp           196.  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> drat             3.70</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gear             4   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> hp             123   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> mpg             19.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> qsec            17.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> vs               0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> wt               3.32</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wide-format">Wide format<a class="anchor" aria-label="anchor" href="#wide-format"></a>
</h2>
<p>And wide format is useful for plotting.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars_tbl</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">hp</span>, <span class="va">mpg</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">hp</span>, <span class="va">mpg</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, label <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: ggrepel: 5 unlabeled data points (too many overlaps). Consider</span></span>
<span><span class="co">#&gt; increasing max.overlaps</span></span></code></pre></div>
<p><img src="class-1_files/figure-html/plot_label-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h2>
<p>Examine the <code>beavers</code> data set (<code>beaver1</code> and <code>beaver2</code>) to identify its variables. Is it in tidy format? If not, how would you rearrange it to make it tidy?</p>
</div>
<div class="section level2">
<h2 id="separate-and-unite">
<code>separate</code> and <code>unite</code><a class="anchor" aria-label="anchor" href="#separate-and-unite"></a>
</h2>
<p><code>separate</code> takes a column containing multiple variables on input and returns multiple columns, each with a new variable. For example, a column with year/month/day information can be separated into invidual columns.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ys</span> <span class="op">&lt;-</span> <span class="fl">1999</span><span class="op">:</span><span class="fl">2002</span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span><span class="op">)</span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span><span class="va">ys</span>, <span class="va">ms</span>, <span class="va">ds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">ys</span><span class="op">:</span><span class="va">ds</span>, sep <span class="op">=</span> <span class="st">'-'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="separate">
<code>separate</code><a class="anchor" aria-label="anchor" href="#separate"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 120 × 1</span></span></span>
<span><span class="co">#&gt;    date       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1999-Feb-1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1999-Feb-2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1999-Feb-3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1999-Feb-4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1999-Feb-5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1999-Feb-6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1999-Feb-7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1999-Feb-8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1999-Feb-9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1999-Feb-10</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 110 more rows</span></span></span>
<span></span>
<span><span class="co"># separate is the inverse of unite</span></span>
<span><span class="va">dates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">date</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">'-'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 120 × 3</span></span></span>
<span><span class="co">#&gt;    year  month day  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1999  Feb   1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1999  Feb   2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1999  Feb   3    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1999  Feb   4    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1999  Feb   5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1999  Feb   6    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1999  Feb   7    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1999  Feb   8    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1999  Feb   9    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1999  Feb   10   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 110 more rows</span></span></span></code></pre></div>
<p>The <code>sep</code> argument can take:</p>
<ul>
<li>a character (split <code>rep_value</code> using <code>sep = '_'</code> into <code>rep</code> and <code>value</code>)</li>
<li>a position (split <code>a1</code> using <code>sep = 1</code> into <code>a</code> and <code>1</code>)</li>
</ul>
<p>Finally the <code>extra</code> and <code>fill</code> arguments to <code>separate</code> control what happens when there are too many and not enough variables.</p>
</div>
<div class="section level2">
<h2 id="crossing-and-complete">
<code>crossing</code> and <code>complete</code><a class="anchor" aria-label="anchor" href="#crossing-and-complete"></a>
</h2>
<p><code>crossing</code> is useful for generating combinations of variables in tibble format. For example, use <code>crossing</code> to generate combinations of experimental varaibles including sample names, gene names, reaction conditions, and replicates.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'wt'</span>, <span class="st">'mut'</span><span class="op">)</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'IFN'</span>, <span class="st">'ACTIN'</span><span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'+'</span>, <span class="st">'-'</span><span class="op">)</span> <span class="co"># reverse transcriptase added?</span></span>
<span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span><span class="va">genotype</span>, <span class="va">gene</span>, <span class="va">time</span>, <span class="va">rep</span>, <span class="va">rt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samples</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 5</span></span></span>
<span><span class="co">#&gt;    genotype gene   time   rep rt   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> mut      ACTIN     0     1 -    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> mut      ACTIN     0     1 +    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> mut      ACTIN     0     2 -    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> mut      ACTIN     0     2 +    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> mut      ACTIN     0     3 -    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> mut      ACTIN     0     3 +    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mut      ACTIN    12     1 -    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> mut      ACTIN    12     1 +    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> mut      ACTIN    12     2 -    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> mut      ACTIN    12     2 +    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 86 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-in-the-96-well-plate-format-">Data in the 96-well plate format.<a class="anchor" aria-label="anchor" href="#data-in-the-96-well-plate-format-"></a>
</h2>
<p>Now we’ll use tidy data principles to analyze some qPCR data.</p>
<p>Many biological assays make use of the 96 (or 384) well plate. Note the similarity between the plate and a <code>tibble</code>: there are rows and columns, and each well contains a reaction that will generate one or more data points.</p>
<div class="figure">
<img src="img/plate.jpg" alt=""><p class="caption">plate</p>
</div>
</div>
<div class="section level2">
<h2 id="sample-names">Sample names<a class="anchor" aria-label="anchor" href="#sample-names"></a>
</h2>
<p>All variables should be systematically listed in your sample names, i.e. <code>name_rep_time_RT</code>. Systematic naming makes it easy to extract relevant information.</p>
<p>Take this example, where the sample names are a combination of a genotype (<code>WT</code> and <code>MT</code>), a time point (0,4,8,24 hour), and a replicate (1,2,3), separated by a hyphen.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 2</span></span></span>
<span><span class="co">#&gt;    sample.name value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> MT-t0-1        71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> MT-t0-2        77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> MT-t0-3        51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> MT-t24-1       88</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> MT-t24-2       50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> MT-t24-3       90</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> MT-t4-1        67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> MT-t4-2         9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> MT-t4-3        84</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> MT-t8-1        29</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="extracting-sample-names">Extracting sample names<a class="anchor" aria-label="anchor" href="#extracting-sample-names"></a>
</h2>
<p>Because the samples have systematic names, it is easy to separate this information into individual columns.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_info</span> <span class="op">&lt;-</span> <span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>    <span class="va">sample.name</span>,</span>
<span>    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sample'</span>, <span class="st">'hour'</span>, <span class="st">'rep'</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"-"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">sample_info</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 4</span></span></span>
<span><span class="co">#&gt;    sample hour  rep   value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> MT     t0    1        71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> MT     t0    2        77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> MT     t0    3        51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> MT     t24   1        88</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> MT     t24   2        50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> MT     t24   3        90</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> MT     t4    1        67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> MT     t4    2         9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> MT     t4    3        84</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> MT     t8    1        29</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 14 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-manipulation">Data manipulation<a class="anchor" aria-label="anchor" href="#data-manipulation"></a>
</h2>
<p>Now we can use <code>dplyr</code> and <code>tidyr</code> functions to manipulate the data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate summary statistics</span></span>
<span><span class="va">sample_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">hour</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'sample'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   sample [2]</span></span></span>
<span><span class="co">#&gt;   sample hour  `mean(value)`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> MT     t0             66.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> MT     t24            76  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> MT     t4             53.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> MT     t8             57.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> WT     t0             28  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> WT     t24            69.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> WT     t4             51  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> WT     t8             35.7</span></span>
<span></span>
<span><span class="co"># subtract a background value. N.B.: rearranging the table makes this calculation easy.</span></span>
<span><span class="va">sample_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">hour</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>t24_norm <span class="op">=</span> <span class="va">t24</span> <span class="op">-</span> <span class="va">t0</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   sample rep      t0   t24    t4    t8 t24_norm</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> MT     1        71    88    67    29       17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> MT     2        77    50     9    78      -<span style="color: #BB0000;">27</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> MT     3        51    90    84    65       39</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> WT     1        53    66    60    22       13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> WT     2         7    82    57    32       75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> WT     3        24    61    36    53       37</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="qpcr-data">qPCR data<a class="anchor" aria-label="anchor" href="#qpcr-data"></a>
</h2>
<p>The class library provides two related tibbles that describe a simulated qPCR experiment called <code>qpcr_names</code> and <code>qpcr_data</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rnabioco/practical-data-analysis" class="external-link">pbda</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">qpcr_names</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 13</span></span></span>
<span><span class="co">#&gt;   row   `1`    `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`   `10`  `11` </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_0… wt_1… wt_2… wt_2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_0… wt_1… wt_2… wt_2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_0… wt_1… wt_2… wt_2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> D     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_0… wt_1… wt_2… wt_2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> E     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_1… wt_1… wt_2… wt_4…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> F     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_1… wt_1… wt_2… wt_4…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> G     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_1… wt_1… wt_2… wt_4…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> H     mut_0… mut_… mut_… mut_… mut_… mut_… wt_0… wt_1… wt_1… wt_2… wt_4…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: `12` &lt;chr&gt;</span></span></span>
<span></span>
<span><span class="va">qpcr_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 13</span></span></span>
<span><span class="co">#&gt;   row     `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`  `10`  `11`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A       2.6  10.5   9.2  20    146.  83.6   2.4  10.5  10.4  19    146.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B       0     0     0     0      0    0     0     0     0     0      0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C       1.6  16.5  79.5  20    146. 680.    1.2  12    78    19.2  144 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> D       0     0     0     0      0    0     0     0     0     0      0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> E       2.8  11    79.5  19.8  105  663     2     9    69    19.8   71 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> F       0     0     0     0      0    0     0     0     0     0      0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> G      12     9.8  78   144    116  774    22.5  11    73.5 146.   118.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> H       0     0     0     0      0    0     0     0     0     0      0 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: `12` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We will use tidying concepts to prepare this data for efficient analysis and visualization.</p>
</div>
<div class="section level2">
<h2 id="qpcr-data-tidying">qPCR data tidying<a class="anchor" aria-label="anchor" href="#qpcr-data-tidying"></a>
</h2>
<ul>
<li>Tidy <code>qpcr_data</code> and <code>qpcr_names</code> into a structure like:</li>
</ul>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 3</span></span></span>
<span><span class="co">#&gt;    row   col     exp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A     1       2.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> B     1       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> C     1       1.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> D     1       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E     1       2.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> F     1       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> G     1      12  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H     1       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A     2      10.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> B     2       0  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 86 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="sample-names-1">Sample names<a class="anchor" aria-label="anchor" href="#sample-names-1"></a>
</h2>
<ul>
<li>Separate variables into new columns in <code>qpcr_names_tidy</code>.</li>
</ul>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 7</span></span></span>
<span><span class="co">#&gt;    row   col   sample time  gene  rt    rep  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A     1     mut    0     ACTIN +     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> B     1     mut    0     ACTIN -     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> C     1     mut    0     ACTIN +     2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> D     1     mut    0     ACTIN -     2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E     1     mut    0     ACTIN +     3    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> F     1     mut    0     ACTIN -     3    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> G     1     mut    0     IFN   +     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H     1     mut    0     IFN   -     1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A     2     mut    0     IFN   +     2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> B     2     mut    0     IFN   -     2    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 86 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="data-joining">Data joining<a class="anchor" aria-label="anchor" href="#data-joining"></a>
</h2>
<ul>
<li>Join the tidied data together.</li>
</ul>
<pre><code><span><span class="co">#&gt; Joining, by = c("row", "col")</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 8</span></span></span>
<span><span class="co">#&gt;    row   col   sample time  gene  rt    rep     exp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A     1     mut    0     ACTIN +     1       2.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> B     1     mut    0     ACTIN -     1       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> C     1     mut    0     ACTIN +     2       1.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> D     1     mut    0     ACTIN -     2       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E     1     mut    0     ACTIN +     3       2.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> F     1     mut    0     ACTIN -     3       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> G     1     mut    0     IFN   +     1      12  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H     1     mut    0     IFN   -     1       0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A     2     mut    0     IFN   +     2      10.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> B     2     mut    0     IFN   -     2       0  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 86 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="statistical-summary">Statistical summary<a class="anchor" aria-label="anchor" href="#statistical-summary"></a>
</h2>
<ul>
<li>Calculate summary statistics for each gene, cell and time point across replicates.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qpcr_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">==</span> <span class="st">"+"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">gene</span>, <span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span>, var_exp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'sample', 'gene'. You can override</span></span>
<span><span class="co">#&gt; using the `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   sample, gene [4]</span></span></span>
<span><span class="co">#&gt;    sample gene  time  mean_exp   var_exp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> mut    ACTIN 0         2.33    0.413 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> mut    ACTIN 12       10       0.840 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> mut    ACTIN 24       19.9     0.013<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> mut    ACTIN 48      102.    271.    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> mut    IFN   0        13       9.75  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> mut    IFN   12       79       0.75  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mut    IFN   24      145       0.75  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> mut    IFN   48      706.   <span style="text-decoration: underline;">3</span>587.    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> wt     ACTIN 0         1.87    0.373 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> wt     ACTIN 12       10.1     1.05  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> wt     ACTIN 24       19.3     0.173 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> wt     ACTIN 48      101.    673.    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> wt     IFN   0        15      42.8   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> wt     IFN   12       73.5    20.2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> wt     IFN   24      145       0.75  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> wt     IFN   48      780.   <span style="text-decoration: underline;">9</span>633</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<ul>
<li><p>Plot the expression for each gene over time.</p></li>
<li><p>Calculate a fold-change for IFN over ACTIN and re-plot.</p></li>
</ul>
<p><img src="class-1_files/figure-html/qpcr_plot-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Tidy the <code>mtcars</code> data set. Note that car names are rownames in the built-in data, so they need to be moved to their own column prior to tibble conversion. You can use <code>tibble:rownames_to_column()</code> for this purpose.</li>
</ol>
<p>The tidied data should look something like:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 352 × 3</span></span></span>
<span><span class="co">#&gt;    name              var   value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Mazda RX4         mpg    21  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Mazda RX4 Wag     mpg    21  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Datsun 710        mpg    22.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Hornet 4 Drive    mpg    21.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Hornet Sportabout mpg    18.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Valiant           mpg    18.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Duster 360        mpg    14.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Merc 240D         mpg    24.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Merc 230          mpg    22.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Merc 280          mpg    19.2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 342 more rows</span></span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>For each car in the tidy <code>mtcars</code> data set, calculate the mean (<code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>) and variance (<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var()</a></code>) for each variable. Try using <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarize_at()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarize_all()</a></code>.</p></li>
<li><p>Plot <code>mpg</code> vs <code>cyl</code> for the <code>mtcars</code> data set. Which format should you use? The original data set, or the tidied one? Why?</p></li>
<li><p>Using the provided <code>qpcr</code> data, plot the changes in gene expression over time. Use colors to represent genotypes and facets for the different genes. If that’s too easy, add error bars (<code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar()</a></code>) and connect each point with a line (<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code>).</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="too-easy">Too Easy?<a class="anchor" aria-label="anchor" href="#too-easy"></a>
</h2>
<p>If you found those exercises too easy, try these:</p>
<ol style="list-style-type: decimal">
<li>Tidy the <code>anscombe</code> data set. Your tidy data should look like:</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 44 x 3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>   set       x     y</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">1</span>         <span class="dv">4</span>  <span class="fl">4.26</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">1</span>         <span class="dv">5</span>  <span class="fl">5.68</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">1</span>         <span class="dv">6</span>  <span class="fl">7.24</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">1</span>         <span class="dv">7</span>  <span class="fl">4.82</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">1</span>         <span class="dv">8</span>  <span class="fl">6.95</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">1</span>         <span class="dv">9</span>  <span class="fl">8.81</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">1</span>        <span class="dv">10</span>  <span class="fl">8.04</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">1</span>        <span class="dv">11</span>  <span class="fl">8.33</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">1</span>        <span class="dv">12</span> <span class="fl">10.8</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1</span>        <span class="dv">13</span>  <span class="fl">7.58</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ... with 34 more rows</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Calculate summary statistics in your tidy <code>anscombe</code> data. Calculate <code>n</code>, <code>mean</code>, and <code>var</code> for each <code>x</code> and <code>y</code> variable in the sets. Try using <code>summarize_each</code> for this calculation.</li>
</ol>
<p>Calculate the <code>cor</code> between <code>x</code> and <code>y</code> for each set. What do you infer from these summary statistics?</p>
<ol start="3" style="list-style-type: decimal">
<li>Plot the tidy <code>anscombe</code> data. Plot each <code>x</code>/<code>y</code> point on separate facets for each set, and plot a smoothing line. Examine the plots. How do they compare to the summary statistics?</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">anscombe_tidy</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">set</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>An R package developed by the <a href="https://medschool.cuanschutz.edu/rbi" class="external-link">RNA Bioscience Initiative</a></p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
